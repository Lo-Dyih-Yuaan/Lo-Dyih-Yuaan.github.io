<!DOCTYPE html>
<html>
<head> 
	<meta charset="utf-8">
	<title>像素板</title>
	<script src="PixelCanvas.js"></script>
	<script src="data.min.js"></script>
</head>
<body>
<div id="schemes" style="display: grid; grid-template-columns: repeat(7, 1fr);">
	<button onclick="main(anshan1)">鞍山第一期</button>
	<button onclick="main(albacore1)">大青花鱼</button>
	<button onclick="main(anshan2)">鞍山第二期</button>
	<button onclick="main(akashi1)">明石</button>
	<button onclick="main(jupiter1)">丘比特</button>
	<button onclick="main(anshan3)">鞍山第三期</button>
	<button onclick="main(illustrious_lily1)">小光辉</button>
</div>
<div id="colors"></div>
<div id="patterns"></div>
<hr/>
<canvas id="canvas">您的浏览器不支持canvas。</canvas>
<button onclick="blhxhhb.save()">保存</button>
<script>
function main(scheme) {
	let defaultColor = Object.keys(scheme.colors).sort().pop();
	let canvas = document.getElementById("canvas");
	let pixelCanvas = new PixelCanvas(canvas, scheme.width, scheme.height, scheme.colors, defaultColor);
	pixelCanvas.canvas.onclick = function (event) {
		let pixelSize = pixelCanvas.pixelSize;
		let borderSize = pixelCanvas.borderSize;
		let elementSize = pixelSize + borderSize;
		let x = event.pageX - canvas.offsetLeft;
		let y = event.pageY - canvas.offsetTop;
		let j = parseInt(x/elementSize);
		let i = parseInt(y/elementSize);
		if (x%elementSize >= borderSize && y%elementSize >= borderSize)
			pixelCanvas.daub(i, j);
	};
	function clickButton(text, onclick, style = {}) {
		let button = document.createElement('button');
		button.textContent = text;
		button.onclick = onclick;
		Object.assign(button.style, style);
		return button;
	}
	let colorsButton = document.getElementById("colors");
	colorsButton.innerHTML = "";
	colorsButton.style.display = 'grid';
	colorsButton.style.gridTemplateColumns = `repeat(${Object.keys(scheme.colors).length}, 1fr)`;
	for (let c in scheme.colors)
		colorsButton.appendChild(clickButton(
			c == defaultColor ? "擦除" : c,
			function () { pixelCanvas.fillColor = c; },
			{background: `linear-gradient(to right, ${scheme.colors[c]}, white, ${scheme.colors[c]})`}));
	let patternsButton = document.getElementById("patterns");
	patternsButton.innerHTML = "";
	patternsButton.style.display = 'grid';
	patternsButton.style.gridTemplateColumns = `repeat(${scheme.patterns.length+1}, 1fr)`;
	for (let i in scheme.patterns)
		patternsButton.appendChild(clickButton(parseInt(i)+1, () => { pixelCanvas.paint(scheme.patterns[i]); }));
	patternsButton.appendChild(clickButton("清空", () => { pixelCanvas.paint(defaultColor); }));
	window.blhxhhb = pixelCanvas
}
main(illustrious_lily1);
</script>
</body>
</html>
